#### CDH集群规划（3台机器）

| 操作系统 | hostname | ip              |
| -------- | -------- | --------------- |
| CentOS 7 | cdh101   | 192.168.142.101 |
| CentOS 7 | cdh102   | 192.168.142.102 |
| CentOS 7 | cdh103   | 192.168.142.103 |

#### 3台主机名配置，临时配置和永久配置

在192.168.142.101机器上配置主机名为：cdh101

```
[root@localhost ~]# hostname cdh101
[root@localhost ~]# vi /etc/hostname
cdh101
```

在192.168.142.102机器上配置主机名为：cdh102

```
[root@localhost ~]# hostname cdh102
[root@localhost ~]# vi /etc/hostname
cdh102
```

在192.168.142.103机器上配置主机名为：cdh103

```
[root@localhost ~]# hostname cdh103
[root@localhost ~]# vi /etc/hostname
cdh103
```



#### 绑定所有机器的主机名和ip映射关系

在cdh101节点操作

```
[root@cdh01 ~]# vi /etc/hosts
192.168.142.101 cdh101
192.168.142.102 cdh102
192.168.142.103 cdh103
```

在cdh102节点操作

```
[root@cdh02 ~]# vi /etc/hosts
192.168.142.101 cdh101
192.168.142.102 cdh102
192.168.142.103 cdh103
```

在cdh103节点操作

```
[root@cdh03 ~]# vi /etc/hosts
192.168.142.101 cdh101
192.168.142.102 cdh102
192.168.142.103 cdh103
```

> *设置完成之后，相互测试主机之间是否可以相互ping通*

#### 关闭3台主机的防火墙配置

```
[root@cdh01 ~]# systemctl stop firewalld
[root@cdh01 ~]# systemctl disable firewalld
Removed symlink /etc/systemd/system/multi-user.target.wants/firewalld.service.
Removed symlink /etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service.
```

#### 实现集群主机相互免密码登陆

1. 配置sshd

   ```
   vi /etc/ssh/sshd_config
   AuthorizedKeysFile .ssh/authorized_keys
   PubkeyAuthentication yes
   ##第一个配置路径，放开允许免密登陆设置
   ```

   

2. 重启sshd

   ```
   systemctl restart sshd
   ```

3. 生成公钥

   ```
   ssh-keygen -t rsa
   ##一直回车，不需要输入密码
   ```

4. 添加公钥

   ```
   cat id_rsa.pub >> authorized_keys
   ```

5. 赋予权限

   ```
   chmod 700 ~/.ssh
   chmod 700 ~/.ssh/authorized_keys
   ```

6. 验证

   ```
   ssh cdh101
   ##节点cdh102,103 一样的步骤
   ```

7. 配置101，到102，103免密登陆

   ```
   scp ~/.ssh/authorized_keys  cdh102:~/
   scp ~/.ssh/authorized_keys  cdh103:~/
   ##101节点之下拷贝到102,103操作
   
   cat ~/authorized_keys >> ~/.ssh/authorized_keys
   ##在102，和103节点上执行操作
   ssh cdh102
   ssh cdh103
   ##验证
   ```

#### 配置集群时间同步工具

```
[root@cdh01 ~]# yum -y install ntp
[root@cdh01 ~]# vi /etc/ntp.conf
.....
# 将下面这四行内容注释掉
#server 0.centos.pool.ntp.org iburst
#server 1.centos.pool.ntp.org iburst
#server 2.centos.pool.ntp.org iburst
#server 3.centos.pool.ntp.org iburst

# 然后增加一行内容
server ntp.aliyun.com

##启动ntp服务
[root@cdh01 ~]# service ntpd start
Redirecting to /bin/systemctl start ntpd.service

##增加服务到开机启动项
[root@cdh01 ~]# systemctl enable ntpd.service
Created symlink from /etc/systemd/system/multi-user.target.wants/ntpd.service to /usr/lib/systemd/system/ntpd.service.

##验证执行命令
[root@cdh01 ~]# ntpq -p          
     remote           refid      st t when poll reach   delay   offset  jitter
==============================================================================
*203.107.6.88    100.107.25.114   2 u   40  128  377   36.058   -7.906   1.142
[root@cdh01 ~]# ntpstat 
synchronised to NTP server (203.107.6.88) at stratum 3
   time correct to within 42 ms
   polling server every 128 s
```

